<!DOCTYPE html>
<html class="no-js" lang="zh-cn">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【Ray】Ray Data 模块入门 - Zhu Xingda</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="上下而求索" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">上下而求索</div>
					<div class="logo__tagline">朱兴达的个人博客</div>
				</div>
		</a>
	</div>
		
<nav class="menu">
	<button class="menu__btn" aria-haspopup="true" aria-expanded="false" tabindex="0">
		<span class="menu__btn-title" tabindex="-1">菜单</span>
	</button>
	<ul class="menu__list">
		<li class="menu__item">
			<a class="menu__link" href="/">
				
				<span class="menu__text">主页</span>
				
			</a>
		</li>
		<li class="menu__item menu__item--active">
			<a class="menu__link" href="/tech/">
				
				<span class="menu__text">技术</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/note/">
				
				<span class="menu__text">笔记本</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="">
				
				<span class="menu__text">生活</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/%E5%85%B3%E4%BA%8E%E6%88%91/">
				
				<span class="menu__text">关于我</span>
				
			</a>
		</li>
	</ul>
</nav>

	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【Ray】Ray Data 模块入门</h1>
			<div class="post__meta meta">
<div class="meta__item-datetime meta__item">
	<svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0a14 14 0 1 1 0 28 1 1 0 0 1 0-28m0 3a3 3 0 1 0 0 22 3 3 0 0 0 0-22m1 4h-2v8.4l6.8 4.4L22 18l-6-3.8z"/></svg><time class="meta__text" datetime="2025-05-15T15:39:42&#43;08:00">2025-05-15</time></div><div class="meta__item-categories meta__item"><svg class="meta__icon icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2 1 2h8v11H0V2z"/></svg><span class="meta__text"><a class="meta__link" href="/categories/%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F/" rel="category">分布式系统</a>
	</span>
</div></div>
		</header>
		
		
		<div class="content post__content clearfix">
			<p>Ray 框架提供 Ray Data 模块用于分布式数据处理、模型批量离线推理、模型训练数据摄入等场景。</p>
<h2 id="1-基本概念">1. 基本概念</h2>
<h4 id="11-定义">1.1 定义</h4>
<ul>
<li><strong>DataSet</strong> 表示一组从外部系统读取或缓存在内存中的分布式数据集，对数据的导入和处理都基于 DataSet 定义</li>
<li><strong>Block</strong> 一个 DataSet 由多个 Blocks 组成，每个 Block 表示一组<strong>连续</strong>的数据行，每个 Block 在分布式系统中被独立处理，有点类似 Flink 里的 Split</li>
<li><strong>Plan</strong> 通过 Ray Dataset API 编写的任务被构造成 <code>Logical Plan</code>，经过 <strong>LogicalOptimizer</strong> 优化后变成 <code>Optimized Logical Plan</code>，开始执行后经过 <strong>Planner</strong> 转换成 <code>Physical Plan</code>，再经过 <strong>PhysicalOptimizer</strong> 优化成 <code>Optimized Physical Plan</code>，优化包括将多个 Operators 合并到一起</li>
<li><strong>Operator</strong> 是组成 Plan 的基本元素，<code>Logical Plan</code> 对应 <code>Logical Operator</code>，<code>Physical Plan</code> 对应 <code>Physical Operator</code></li>
</ul>
<h4 id="12-physical-operator-的运行过程">1.2 Physical Operator 的运行过程</h4>
<ol>
<li>获取一批 Blocks 的引用</li>
<li>对这些 Blocks 执行 Operation（要么用 Ray 的 Tasks/Actors 对数据按 UDF 做转换，要么只操作 Blocks 的引用）</li>
<li>输出新的 Blocks 的引用</li>
</ol>
<h4 id="13-流式计算">1.3 流式计算</h4>
<p>Ray Data 支持以 streaming 的形式处理整个 DataSet（这里暂时不确定是以 Block 为基本处理单位的 mini batch 式还是以 Row 为单位的真 streaming）<br>
<img alt="官网示例拓扑图" src="https://docs.ray.io/en/latest/_images/streaming-topology.svg">
如官方文档里的拓扑图所示，Operators 通过 InputQueue 和 OutputQueue 连接成 pipeline，这里有一些与 Flink 对比后未解决的问题：</p>
<ol>
<li>Operator 的上下游逻辑上是否支持多路输入输出</li>
<li>如何实现容错和恢复</li>
<li>Operator 在并发执行的时候是如何划分 partition 以及如何 shuffle</li>
</ol>
<h2 id="2-代码测试">2. 代码测试</h2>
<h4 id="21-集群搭建">2.1 集群搭建</h4>
<p>见 <a href="/tech/ray_framework_init/">前文</a></p>
<h4 id="22-测试环境和-hello-world">2.2 测试环境和 Hello World</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ conda create --name ray_hello_world python<span style="color:#f92672">=</span>3.13.2
</span></span><span style="display:flex;"><span>$ conda activate ray_hello_world
</span></span><span style="display:flex;"><span>$ pip install -U <span style="color:#e6db74">&#34;ray[data]&#34;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> ray
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> typing <span style="color:#f92672">import</span> Dict
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 从本地文件读取数据</span>
</span></span><span style="display:flex;"><span>ds <span style="color:#f92672">=</span> ray<span style="color:#f92672">.</span>data<span style="color:#f92672">.</span>read_csv(<span style="color:#e6db74">&#34;local:///Users/zhuxingda/Projects/ray_hello_world/test_data.csv&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 打印第一行</span>
</span></span><span style="display:flex;"><span>ds<span style="color:#f92672">.</span>show(limit<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 定义一个 transformation 在 dataset 里新增一列</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">transform_batch</span>(batch: Dict[str, np<span style="color:#f92672">.</span>ndarray]) <span style="color:#f92672">-&gt;</span> Dict[str, np<span style="color:#f92672">.</span>ndarray]:
</span></span><span style="display:flex;"><span>    weight <span style="color:#f92672">=</span> batch[<span style="color:#e6db74">&#34;weight (kg)&#34;</span>]
</span></span><span style="display:flex;"><span>    height <span style="color:#f92672">=</span> batch[<span style="color:#e6db74">&#34;height (m)&#34;</span>]
</span></span><span style="display:flex;"><span>    batch[<span style="color:#e6db74">&#34;BMI&#34;</span>] <span style="color:#f92672">=</span> weight<span style="color:#f92672">/</span>(height<span style="color:#f92672">*</span>height)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> batch
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 将 transformation 应用到 dataset</span>
</span></span><span style="display:flex;"><span>transformed_ds <span style="color:#f92672">=</span> ds<span style="color:#f92672">.</span>map_batches(transform_batch)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 展示更新后的 Schema 和数据 </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># .materialize() 将会执行所有 lazy transformations 并将</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># dataset materialize 到 ray 的 object store memory</span>
</span></span><span style="display:flex;"><span>print(transformed_ds<span style="color:#f92672">.</span>materialize())
</span></span><span style="display:flex;"><span>transformed_ds<span style="color:#f92672">.</span>show(limit<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
</span></span></code></pre></div><p>执行之后控制台输出</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ python3 hello_world.py 
</span></span><span style="display:flex;"><span>2025-05-16 18:41:54,451 INFO worker.py:1888 -- Started a local Ray instance.
</span></span><span style="display:flex;"><span>2025-05-16 18:41:55,153 INFO dataset.py:3027 -- Tip: Use <span style="color:#e6db74">`</span>take_batch<span style="color:#f92672">()</span><span style="color:#e6db74">`</span> instead of <span style="color:#e6db74">`</span>take<span style="color:#f92672">()</span> / show<span style="color:#f92672">()</span><span style="color:#e6db74">`</span> to <span style="color:#66d9ef">return</span> records in pandas or numpy batch format.
</span></span><span style="display:flex;"><span>2025-05-16 18:41:55,158 INFO logging.py:290 -- Registered dataset logger <span style="color:#66d9ef">for</span> dataset dataset_1_0
</span></span><span style="display:flex;"><span>2025-05-16 18:41:55,167 INFO streaming_executor.py:117 -- Starting execution of Dataset dataset_1_0. Full logs are in /tmp/ray/session_2025-05-16_18-41-53_987376_54433/logs/ray-data
</span></span><span style="display:flex;"><span>2025-05-16 18:41:55,167 INFO streaming_executor.py:118 -- Execution plan of Dataset dataset_1_0: InputDataBuffer<span style="color:#f92672">[</span>Input<span style="color:#f92672">]</span> -&gt; TaskPoolMapOperator<span style="color:#f92672">[</span>ReadCSV<span style="color:#f92672">]</span> -&gt; LimitOperator<span style="color:#f92672">[</span>limit<span style="color:#f92672">=</span>1<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>Running 0: 0.00 row <span style="color:#f92672">[</span>00:00, ? row/s<span style="color:#f92672">]</span>  2025-05-16 18:41:55,405   INFO streaming_executor.py:220 -- ✔️  Dataset dataset_1_0 execution finished in 0.24 seconds
</span></span><span style="display:flex;"><span>✔️  Dataset dataset_1_0 execution finished in 0.24 seconds: : 1.00 row <span style="color:#f92672">[</span>00:00, 4.35 row/s<span style="color:#f92672">]</span> 
</span></span><span style="display:flex;"><span>- ReadCSV-&gt;SplitBlocks<span style="color:#f92672">(</span>20<span style="color:#f92672">)</span>: Tasks: 1; Queued blocks: 0; Resources: 1.0 CPU, 24.0B object store: : 1.00 row <span style="color:#f92672">[</span>00:00, 4.40 row/s<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>- limit<span style="color:#f92672">=</span>1: Tasks: 0; Queued blocks: 1; Resources: 0.0 CPU, 36.0B object store: : 1.00 row <span style="color:#f92672">[</span>00:00, 4.40 row/s<span style="color:#f92672">]</span>                 
</span></span><span style="display:flex;"><span><span style="color:#f92672">{</span><span style="color:#e6db74">&#39;name&#39;</span>: <span style="color:#e6db74">&#39;xiaomign&#39;</span>, <span style="color:#e6db74">&#39;age&#39;</span>: 10, <span style="color:#e6db74">&#39;weight (kg)&#39;</span>: 70, <span style="color:#e6db74">&#39;height (m)&#39;</span>: 1.73<span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>2025-05-16 18:41:55,409 INFO logging.py:290 -- Registered dataset logger <span style="color:#66d9ef">for</span> dataset dataset_3_0             
</span></span><span style="display:flex;"><span>2025-05-16 18:41:55,411 INFO streaming_executor.py:117 -- Starting execution of Dataset dataset_3_0. Full logs are in /tmp/ray/session_2025-05-16_18-41-53_987376_54433/logs/ray-data
</span></span><span style="display:flex;"><span>2025-05-16 18:41:55,411 INFO streaming_executor.py:118 -- Execution plan of Dataset dataset_3_0: InputDataBuffer<span style="color:#f92672">[</span>Input<span style="color:#f92672">]</span> -&gt; TaskPoolMapOperator<span style="color:#f92672">[</span>ReadCSV<span style="color:#f92672">]</span> -&gt; TaskPoolMapOperator<span style="color:#f92672">[</span>MapBatches<span style="color:#f92672">(</span>transform_batch<span style="color:#f92672">)]</span>
</span></span><span style="display:flex;"><span>Running 0: 0.00 row <span style="color:#f92672">[</span>00:00, ? row/s<span style="color:#f92672">]</span>                      2025-05-16 18:41:56,032       INFO streaming_executor.py:220 -- ✔️  Dataset dataset_3_0 execution finished in 0.62 seconds-&gt;SplitBlocks<span style="color:#f92672">(</span>20<span style="color:#f92672">)</span> 1: 0.00 row <span style="color:#f92672">[</span>00:00, ? row/s<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>✔️  Dataset dataset_3_0 execution finished in 0.62 seconds: 100%|████████████████████████████████████████████████████████████████████| 1.00/1.00 <span style="color:#f92672">[</span>00:00&lt;00:00, 1.61 row/s<span style="color:#f92672">]</span> 
</span></span><span style="display:flex;"><span>- ReadCSV-&gt;SplitBlocks<span style="color:#f92672">(</span>20<span style="color:#f92672">)</span>: Tasks: 0; Queued blocks: 0; Resources: 0.0 CPU, 0.0B object store: 100%|█████████████████████████████████| 1.00/1.00 <span style="color:#f92672">[</span>00:00&lt;00:00, 1.61 row/s<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>- MapBatches<span style="color:#f92672">(</span>transform_batch<span style="color:#f92672">)</span>: Tasks: 0; Queued blocks: 0; Resources: 0.0 CPU, 0.0B object store: 100%|██████████████████████████████| 1.00/1.00 <span style="color:#f92672">[</span>00:00&lt;00:00, 1.61 row/s<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>MaterializedDataset<span style="color:#f92672">(</span>                                      
</span></span><span style="display:flex;"><span>   num_blocks<span style="color:#f92672">=</span>20,                                                                                                                                                         
</span></span><span style="display:flex;"><span>   num_rows<span style="color:#f92672">=</span>1,
</span></span><span style="display:flex;"><span>   schema<span style="color:#f92672">={</span>
</span></span><span style="display:flex;"><span>      name: string,
</span></span><span style="display:flex;"><span>      age: int64,
</span></span><span style="display:flex;"><span>      weight <span style="color:#f92672">(</span>kg<span style="color:#f92672">)</span>: int64,
</span></span><span style="display:flex;"><span>      height <span style="color:#f92672">(</span>m<span style="color:#f92672">)</span>: double,
</span></span><span style="display:flex;"><span>      BMI: double
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>2025-05-16 18:41:56,036 INFO logging.py:290 -- Registered dataset logger <span style="color:#66d9ef">for</span> dataset dataset_5_0
</span></span><span style="display:flex;"><span>2025-05-16 18:41:56,039 INFO streaming_executor.py:117 -- Starting execution of Dataset dataset_5_0. Full logs are in /tmp/ray/session_2025-05-16_18-41-53_987376_54433/logs/ray-data
</span></span><span style="display:flex;"><span>2025-05-16 18:41:56,039 INFO streaming_executor.py:118 -- Execution plan of Dataset dataset_5_0: InputDataBuffer<span style="color:#f92672">[</span>Input<span style="color:#f92672">]</span> -&gt; TaskPoolMapOperator<span style="color:#f92672">[</span>ReadCSV<span style="color:#f92672">]</span> -&gt; TaskPoolMapOperator<span style="color:#f92672">[</span>MapBatches<span style="color:#f92672">(</span>transform_batch<span style="color:#f92672">)]</span> -&gt; LimitOperator<span style="color:#f92672">[</span>limit<span style="color:#f92672">=</span>1<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>Running 0: 0.00 row <span style="color:#f92672">[</span>00:00, ? row/s<span style="color:#f92672">]</span>  2025-05-16 18:41:56,066   INFO streaming_executor.py:220 -- ✔️  Dataset dataset_5_0 execution finished in 0.03 seconds
</span></span><span style="display:flex;"><span>✔️  Dataset dataset_5_0 execution finished in 0.03 seconds: : 1.00 row <span style="color:#f92672">[</span>00:00, 36.7 row/s<span style="color:#f92672">]</span> 
</span></span><span style="display:flex;"><span>- ReadCSV-&gt;SplitBlocks<span style="color:#f92672">(</span>20<span style="color:#f92672">)</span>: Tasks: 1; Queued blocks: 0; Resources: 1.0 CPU, 14.4B object store: : 1.00 row <span style="color:#f92672">[</span>00:00, 38.5 row/s<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>- MapBatches<span style="color:#f92672">(</span>transform_batch<span style="color:#f92672">)</span>: Tasks: 2; Queued blocks: 0; Resources: 2.0 CPU, 29.3B object store: : 1.00 row <span style="color:#f92672">[</span>00:00, 38.4 row/s<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>- limit<span style="color:#f92672">=</span>1: Tasks: 0; Queued blocks: 2; Resources: 0.0 CPU, 44.0B object store: : 1.00 row <span style="color:#f92672">[</span>00:00, 38.4 row/s<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">{</span><span style="color:#e6db74">&#39;name&#39;</span>: <span style="color:#e6db74">&#39;xiaomign&#39;</span>, <span style="color:#e6db74">&#39;age&#39;</span>: 10, <span style="color:#e6db74">&#39;weight (kg)&#39;</span>: 70, <span style="color:#e6db74">&#39;height (m)&#39;</span>: 1.73, <span style="color:#e6db74">&#39;BMI&#39;</span>: 23.38868655818771<span style="color:#f92672">}</span>
</span></span></code></pre></div><p>看输出可以发现实际执行了三次 dataset 的流式计算，第三次的 Execution Plan 为：</p>
<ol>
<li>InputDataBuffer[Input]</li>
<li>TaskPoolMapOperator[ReadCSV]</li>
<li>TaskPoolMapOperator[MapBatches(transform_batch)]</li>
<li>LimitOperator[limit=1]</li>
</ol>
<h2 id="3-代码结构">3. 代码结构</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>ray/
</span></span><span style="display:flex;"><span>    data/
</span></span><span style="display:flex;"><span>        context.py
</span></span><span style="display:flex;"><span>        dataset.py
</span></span><span style="display:flex;"><span>        _internal/
</span></span><span style="display:flex;"><span>            planner/
</span></span><span style="display:flex;"><span>                planner.py 定义 Planner 负责将 LogicalPlan 转换成 PhysicalPlan
</span></span><span style="display:flex;"><span>            logical/
</span></span><span style="display:flex;"><span>                interfaces/
</span></span><span style="display:flex;"><span>                    plan.py LogicalPlan 和 PhysicalPlan 的公共接口
</span></span><span style="display:flex;"><span>                    operator.py 定义 Operator 公共接口
</span></span><span style="display:flex;"><span>                    logical_plan.py 定义 LogicalPlan
</span></span><span style="display:flex;"><span>                    logical_operator.py 组成 LogicalPlan 的 LogicalOperator 接口
</span></span><span style="display:flex;"><span>                    physical_plan.py 定义 PhysicalPlan
</span></span><span style="display:flex;"><span>                    optimizer.py 定义优化 Plan 的 Rule 和 Optimizer 接口
</span></span><span style="display:flex;"><span>                operators/ 包含一批 LogicalOperator 的实现
</span></span><span style="display:flex;"><span>                rules/ 包含一批 Rule 的实现
</span></span><span style="display:flex;"><span>                optimizers.py 定义实现 Optimizer 接口的 LogicalOptimizer 和 PhysicalOptimizer
</span></span><span style="display:flex;"><span>            execution/
</span></span><span style="display:flex;"><span>                interfaces/
</span></span><span style="display:flex;"><span>                    physical_operator.py 定义 PhysicalOperator 接口
</span></span><span style="display:flex;"><span>                    executor.py 定义 Executor 接口，用于执行 PhysicalOperator
</span></span><span style="display:flex;"><span>                    task_context.py
</span></span><span style="display:flex;"><span>                operators/ 包含一批 PhysicalOperator 的实现
</span></span><span style="display:flex;"><span>                    actor_pool_map_operator.py 包含 _ActorPool 实现了 AutoscalingActorPool 接口，用于 ActorPoolMapOperator 的执行
</span></span><span style="display:flex;"><span>                autoscaler/
</span></span><span style="display:flex;"><span>                    autoscaler.py 定义 Autoscaler 接口
</span></span><span style="display:flex;"><span>                    default_autoscaler.py Autoscaler 接口的默认实现 DefaultAutoscaler
</span></span><span style="display:flex;"><span>                    autoscaling_actor_pool.py 定义 AutoscalingActorPool 接口，表示支持自动扩缩容的 Actor Pool，由 Autoscaler 决定 AutoscalingActorPool 的扩缩绒
</span></span><span style="display:flex;"><span>                backpressure_policy/
</span></span><span style="display:flex;"><span>                    backpressure_policy.py 定义 BackpressurePolicy 接口，表示当数据处理流出现背压后如何控制数据读入的速度
</span></span><span style="display:flex;"><span>                streaming_executor.py 定义 StreamingExecutor 实现 Executor
</span></span><span style="display:flex;"><span>                streaming_executor_state.py 定义 OpState 用于追踪 PhysicalOperator 的运行状态
</span></span><span style="display:flex;"><span>            plan.py 定义 ExecutionPlan
</span></span></code></pre></div>
		</div>
		<footer class="post__footer">
			
<div class="post__tags tags clearfix">
	<svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M4 0h8s2 0 4 2l15 15s2 2 0 4L21 31s-2 2-4 0L2 16s-2-2-2-4V3s0-3 4-3m3 10a3 3 0 0 0 0-6 3 3 0 0 0 0 6"/></svg>
	<ul class="tags__list">
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/ray/" rel="tag">Ray</a>
		</li>
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/ray-data/" rel="tag">Ray Data</a>
		</li>
	</ul>
</div>
		</footer>
	</article>
</main>

<div id="gitalk-container"></div>
<link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
<script>
  const gitalk = new Gitalk({
    clientID: '5e216fcfdd8cdb462b85',
    clientSecret: '10659215d325c41513a047c07f576e345e697b3b',
    repo: 'zhuxingda.github.io',
    owner: 'ZhuXingda',
    admin: ['ZhuXingda'],
    id: location.pathname, 
    distractionFreeMode: false 
  });
  (function() {
    if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
      document.getElementById('gitalk-container').innerHTML = 'Gitalk comments not available by default when the website is previewed locally.';
      return;
    }
    gitalk.render('gitalk-container');
  })();
</script>

<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/tech/tcpdump_usage_notebook/" rel="prev">
			<span class="pager__subtitle">«&thinsp;上一篇</span>
			<p class="pager__title">【Linux】Linux 服务器抓包记录</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/tech/paimon_file_structure/" rel="next">
			<span class="pager__subtitle">下一篇&thinsp;»</span>
			<p class="pager__title">【Paimon】文件结构</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2025 Zhu Xingda.
			<span class="footer__copyright-credits">基于 <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> 引擎和 <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> 主题</span>
		</div>
	</div>
</footer>
	</div>
<script async defer src="/js/menu.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async></script>
</body>
</html>